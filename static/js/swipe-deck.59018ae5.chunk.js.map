{"version":3,"file":"static/js/swipe-deck.59018ae5.chunk.js","mappings":"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","sources":["../node_modules/framer-motion/dist/es/value/use-motion-value.mjs","../node_modules/framer-motion/dist/es/value/use-combine-values.mjs","../node_modules/framer-motion/dist/es/value/use-transform.mjs","../node_modules/framer-motion/dist/es/value/use-computed.mjs","../node_modules/motion-dom/dist/es/utils/transform.mjs","components/chunks/SwipeDeck.jsx"],"sourcesContent":["import { motionValue } from 'motion-dom';\nimport { useContext, useState, useEffect } from 'react';\nimport { MotionConfigContext } from '../context/MotionConfigContext.mjs';\nimport { useConstant } from '../utils/use-constant.mjs';\n\n/**\n * Creates a `MotionValue` to track the state and velocity of a value.\n *\n * Usually, these are created automatically. For advanced use-cases, like use with `useTransform`, you can create `MotionValue`s externally and pass them into the animated component via the `style` prop.\n *\n * ```jsx\n * export const MyComponent = () => {\n *   const scale = useMotionValue(1)\n *\n *   return <motion.div style={{ scale }} />\n * }\n * ```\n *\n * @param initial - The initial state.\n *\n * @public\n */\nfunction useMotionValue(initial) {\n    const value = useConstant(() => motionValue(initial));\n    /**\n     * If this motion value is being used in static mode, like on\n     * the Framer canvas, force components to rerender when the motion\n     * value is updated.\n     */\n    const { isStatic } = useContext(MotionConfigContext);\n    if (isStatic) {\n        const [, setLatest] = useState(initial);\n        useEffect(() => value.on(\"change\", setLatest), []);\n    }\n    return value;\n}\n\nexport { useMotionValue };\n","import { cancelFrame, frame } from 'motion-dom';\nimport { useIsomorphicLayoutEffect } from '../utils/use-isomorphic-effect.mjs';\nimport { useMotionValue } from './use-motion-value.mjs';\n\nfunction useCombineMotionValues(values, combineValues) {\n    /**\n     * Initialise the returned motion value. This remains the same between renders.\n     */\n    const value = useMotionValue(combineValues());\n    /**\n     * Create a function that will update the template motion value with the latest values.\n     * This is pre-bound so whenever a motion value updates it can schedule its\n     * execution in Framesync. If it's already been scheduled it won't be fired twice\n     * in a single frame.\n     */\n    const updateValue = () => value.set(combineValues());\n    /**\n     * Synchronously update the motion value with the latest values during the render.\n     * This ensures that within a React render, the styles applied to the DOM are up-to-date.\n     */\n    updateValue();\n    /**\n     * Subscribe to all motion values found within the template. Whenever any of them change,\n     * schedule an update.\n     */\n    useIsomorphicLayoutEffect(() => {\n        const scheduleUpdate = () => frame.preRender(updateValue, false, true);\n        const subscriptions = values.map((v) => v.on(\"change\", scheduleUpdate));\n        return () => {\n            subscriptions.forEach((unsubscribe) => unsubscribe());\n            cancelFrame(updateValue);\n        };\n    });\n    return value;\n}\n\nexport { useCombineMotionValues };\n","import { transform } from 'motion-dom';\nimport { useConstant } from '../utils/use-constant.mjs';\nimport { useCombineMotionValues } from './use-combine-values.mjs';\nimport { useComputed } from './use-computed.mjs';\n\nfunction useTransform(input, inputRangeOrTransformer, outputRange, options) {\n    if (typeof input === \"function\") {\n        return useComputed(input);\n    }\n    const transformer = typeof inputRangeOrTransformer === \"function\"\n        ? inputRangeOrTransformer\n        : transform(inputRangeOrTransformer, outputRange, options);\n    return Array.isArray(input)\n        ? useListTransform(input, transformer)\n        : useListTransform([input], ([latest]) => transformer(latest));\n}\nfunction useListTransform(values, transformer) {\n    const latest = useConstant(() => []);\n    return useCombineMotionValues(values, () => {\n        latest.length = 0;\n        const numValues = values.length;\n        for (let i = 0; i < numValues; i++) {\n            latest[i] = values[i].get();\n        }\n        return transformer(latest);\n    });\n}\n\nexport { useTransform };\n","import { collectMotionValues } from 'motion-dom';\nimport { useCombineMotionValues } from './use-combine-values.mjs';\n\nfunction useComputed(compute) {\n    /**\n     * Open session of collectMotionValues. Any MotionValue that calls get()\n     * will be saved into this array.\n     */\n    collectMotionValues.current = [];\n    compute();\n    const value = useCombineMotionValues(collectMotionValues.current, compute);\n    /**\n     * Synchronously close session of collectMotionValues.\n     */\n    collectMotionValues.current = undefined;\n    return value;\n}\n\nexport { useComputed };\n","import { interpolate } from './interpolate.mjs';\n\nfunction transform(...args) {\n    const useImmediate = !Array.isArray(args[0]);\n    const argOffset = useImmediate ? 0 : -1;\n    const inputValue = args[0 + argOffset];\n    const inputRange = args[1 + argOffset];\n    const outputRange = args[2 + argOffset];\n    const options = args[3 + argOffset];\n    const interpolator = interpolate(inputRange, outputRange, options);\n    return useImmediate ? interpolator(inputValue) : interpolator;\n}\n\nexport { transform };\n","import React, { useCallback, useEffect, useMemo, useRef, useState } from 'react';\nimport { motion, AnimatePresence, useReducedMotion, useMotionValue, useTransform } from 'framer-motion';\nimport { formatPrice } from '../utils';\nimport { imageCache, performanceMonitor } from '../../utils/imageCache';\n\n/*\n  Redesigned SwipeDeck:\n  - Uses an index pointer instead of mutating an array (less GC & re-renders)\n  - Renders only the top 3 cards + an ephemeral \"leaving\" card during fling\n  - Velocity & distance based fling with spring settle for cancel\n  - Early index advance timed to mid-flight for snappier feel without flicker\n  - Keyboard accessibility (Left/Right to simulate swipe, Enter/Space for details)\n  - Reduced motion friendly (no rotation / depth scale if prefers-reduced-motion)\n  - Preloads next image to cut decode hitch\n*/\n\nconst VISIBLE = 3;\nconst FLY_DISTANCE_EXTRA = 160; // extra px beyond viewport for off-screen flight\nconst FLY_DURATION = 0.38; // s\nconst THRESHOLD_PX = 110;\nconst THRESHOLD_VELO = 620;\n\nconst SwipeDeck = ({ items, onSelect }) => {\n  const [index, setIndex] = useState(0); // pointer to current top\n  const [leaving, setLeaving] = useState(null); // { item, dir, key }\n  const len = items.length;\n  const prefersReduced = useReducedMotion();\n  const viewportW = useRef(typeof window !== 'undefined' ? window.innerWidth : 1024);\n\n  // Update viewport width on resize (cheap)\n  useEffect(() => {\n    const h = () => { viewportW.current = window.innerWidth; };\n    window.addEventListener('resize', h, { passive: true });\n    return () => window.removeEventListener('resize', h);\n  }, []);\n\n  // Preload the image 2 steps ahead with caching\n  useEffect(() => {\n    if (!len) return;\n\n    performanceMonitor.markStart('swipe-preload');\n    const preloadIdx = (index + VISIBLE) % len;\n    const imageUrl = imageCache.getImageUrls(items[preloadIdx].image, {\n      widths: [720, 900],\n      quality: 60,\n      formats: ['webp', 'jpg']\n    }).base;\n\n    imageCache.preloadImage(imageUrl, 'low')\n      .then(() => performanceMonitor.markEnd('swipe-preload'))\n      .catch(() => performanceMonitor.markEnd('swipe-preload'));\n  }, [index, items, len]);\n\n  const goNext = useCallback((dir) => {\n    // dir: 1 for right, -1 for left\n    if (!len) return;\n    setIndex(i => (i + 1) % len);\n  }, [len]);\n\n  const displayed = useMemo(() => {\n    if (!len) return [];\n    const arr = [];\n    for (let o = 0; o < Math.min(VISIBLE, len); o++) {\n      const idx = (index + o) % len;\n      arr.push({ item: items[idx], offset: o, stackKey: `${items[idx].id}-${Math.floor((index + o) / len)}` });\n    }\n    return arr;\n  }, [index, items, len]);\n\n  // Public fling trigger used by keyboard / drag\n  const triggerFling = useCallback((dir) => {\n    if (!len) return;\n    const top = items[index];\n    const leaveKey = `${top.id}-leave-${Date.now()}`;\n    setLeaving({ item: top, dir, key: leaveKey });\n    // Advance index mid-flight for responsiveness\n    setTimeout(() => { goNext(dir); }, FLY_DURATION * 500); // about half animation\n    // Clear leaving after animation window\n    setTimeout(() => { setLeaving(l => (l && l.key === leaveKey ? null : l)); }, FLY_DURATION * 1000 + 80);\n  }, [len, items, index, goNext]);\n\n  // Keyboard support\n  useEffect(() => {\n    const handler = (e) => {\n      if (!len) return;\n      if (e.key === 'ArrowLeft' || e.key === 'ArrowRight') {\n        e.preventDefault();\n        triggerFling(e.key === 'ArrowRight' ? 1 : -1);\n      } else if (e.key === 'Enter' || e.key === ' ') {\n        e.preventDefault();\n        onSelect && onSelect(items[index]);\n      }\n    };\n    window.addEventListener('keydown', handler);\n    return () => window.removeEventListener('keydown', handler);\n  }, [index, items, len, onSelect, triggerFling]);\n\n  return (\n    <div className=\"swipe-deck\" aria-label=\"Property swipe deck\" role=\"list\" style={{ position: 'relative' }}>\n      <AnimatePresence>\n        {leaving && (\n          <LeavingCard key={leaving.key} data={leaving} viewportW={viewportW} prefersReduced={prefersReduced} />\n        )}\n      </AnimatePresence>\n      {displayed.map(({ item, offset, stackKey }) => (\n        <CardLayer\n          key={stackKey}\n          item={item}\n          offset={offset}\n          onSelect={onSelect}\n          isTop={offset === 0 && !leaving}\n          triggerFling={triggerFling}\n          prefersReduced={prefersReduced}\n          viewportW={viewportW}\n        />\n      ))}\n    </div>\n  );\n};\n\nconst CardLayer = ({ item, offset, onSelect, isTop, triggerFling, prefersReduced, viewportW }) => {\n  const x = useMotionValue(0);\n  const rotate = useTransform(x, [-320, 320], prefersReduced ? [0, 0] : [-15, 15]);\n  const scale = prefersReduced ? 1 : 1 - offset * 0.05;\n  const y = prefersReduced ? offset * 10 : offset * 14;\n  const shadow = offset === 0 ? '0 18px 40px -18px rgba(0,0,0,.65),0 4px 14px -6px rgba(0,0,0,.5)' : '0 8px 20px -12px rgba(0,0,0,.5)';\n  const draggingRef = useRef(false);\n\n  // Get optimized image URLs\n  const imageUrls = useMemo(() =>\n    imageCache.getImageUrls(item.image, {\n      widths: [720, 900],\n      quality: 60,\n      formats: ['webp', 'jpg']\n    }), [item.image]\n  );\n\n  const handleDragEnd = useCallback((_, info) => {\n    if (!isTop) return;\n    const dist = info.offset.x;\n    const velo = info.velocity.x;\n    const dir = dist > 0 ? 1 : -1;\n    const should = Math.abs(dist) > THRESHOLD_PX || Math.abs(velo) > THRESHOLD_VELO;\n    if (should) {\n      draggingRef.current = false;\n      triggerFling(dir);\n    } else {\n      // spring back\n      x.stop();\n    }\n  }, [isTop, triggerFling, x]);\n\n  return (\n    <motion.div\n      role={isTop ? 'option' : 'presentation'}\n      aria-selected={isTop}\n      className={`swipe-card glass-strong${isTop ? ' top' : ''}`}\n      style={{\n        backgroundImage: `url(${imageUrls.base})`,\n        zIndex: 50 - offset,\n        x,\n        rotate,\n        scale,\n        y,\n        boxShadow: shadow,\n        cursor: isTop ? 'grab' : 'default',\n        willChange: isTop ? 'transform' : 'auto'\n      }}\n      drag={isTop ? 'x' : false}\n      dragConstraints={{ left: 0, right: 0 }}\n      dragElastic={0.25}\n      onDragEnd={handleDragEnd}\n      whileDrag={prefersReduced ? undefined : { scale: scale * 1.035, y: y - 4 }}\n      initial={{ opacity: 0, scale: scale * 0.94, y: y + 20 }}\n      animate={{ opacity: 1, scale, y, transition: { duration: 0.4, ease: [0.16, 1, 0.3, 1] } }}\n      exit={{ opacity: 0, y: y - 40, scale: scale * 0.9, transition: { duration: 0.25 } }}\n      onDoubleClick={() => onSelect && onSelect(item)}\n    >\n      <CardInner item={item} onSelect={onSelect} />\n    </motion.div>\n  );\n};\n\nconst LeavingCard = ({ data, viewportW, prefersReduced }) => {\n  const { item, dir } = data;\n  const dist = viewportW.current + FLY_DISTANCE_EXTRA;\n\n  // Get optimized image URLs for leaving card\n  const imageUrls = useMemo(() =>\n    imageCache.getImageUrls(item.image, {\n      widths: [720, 900],\n      quality: 60,\n      formats: ['webp', 'jpg']\n    }), [item.image]\n  );\n\n  return (\n    <motion.div\n      className=\"swipe-card glass-strong leaving\"\n      style={{\n        backgroundImage: `url(${imageUrls.base})`,\n        zIndex: 100,\n        position: 'absolute',\n        inset: 0,\n        cursor: 'default',\n        willChange: 'transform, opacity'\n      }}\n      initial={{ x: 0, y: 0, rotate: 0, scale: 1 }}\n      animate={{\n        x: dir * dist,\n        y: -120,\n        rotate: prefersReduced ? 0 : dir * 26,\n        scale: 1.05,\n        opacity: 0.9,\n        transition: { duration: FLY_DURATION, ease: [0.16, 1, 0.3, 1] }\n      }}\n      exit={{ opacity: 0, transition: { duration: 0.15 } }}\n    >\n      <CardInner item={item} />\n    </motion.div>\n  );\n};\n\nconst CardInner = ({ item, onSelect }) => (\n  <div className=\"swipe-card-overlay\">\n    <div className=\"swipe-meta\">\n      <span className=\"badge\" style={{ marginBottom: '.6rem' }}>{item.type}</span>\n      <h3>{item.title}</h3>\n      <p className=\"loc\">{item.location}</p>\n      <p className=\"price-line\">{formatPrice(item.price)}</p>\n      <div className=\"mini-meta\">{item.beds} BD • {item.baths} BA • {item.size.toLocaleString()} SF</div>\n    </div>\n    {onSelect && <div className=\"swipe-actions\"><button className=\"cta small\" onClick={() => onSelect(item)}>Details</button></div>}\n  </div>\n);\n\nexport default SwipeDeck;\n"],"names":["useMotionValue","initial","value","useConstant","motionValue","isStatic","useContext","MotionConfigContext","setLatest","useState","useEffect","on","useCombineMotionValues","values","combineValues","updateValue","set","useIsomorphicLayoutEffect","scheduleUpdate","frame","preRender","subscriptions","map","v","forEach","unsubscribe","cancelFrame","useTransform","input","inputRangeOrTransformer","outputRange","options","compute","collectMotionValues","current","undefined","useComputed","transformer","useImmediate","Array","isArray","arguments","length","argOffset","inputValue","inputRange","interpolator","interpolate","transform","useListTransform","_ref","latest","numValues","i","get","FLY_DURATION","CardLayer","_ref3","item","offset","onSelect","isTop","triggerFling","prefersReduced","viewportW","x","rotate","scale","y","shadow","draggingRef","useRef","imageUrls","useMemo","imageCache","getImageUrls","image","widths","quality","formats","handleDragEnd","useCallback","_","info","dist","velo","velocity","dir","Math","abs","stop","_jsx","motion","div","role","className","concat","style","backgroundImage","base","zIndex","boxShadow","cursor","willChange","drag","dragConstraints","left","right","dragElastic","onDragEnd","whileDrag","opacity","animate","transition","duration","ease","exit","onDoubleClick","children","CardInner","LeavingCard","_ref4","data","position","inset","_ref5","_jsxs","marginBottom","type","title","location","formatPrice","price","beds","baths","size","toLocaleString","onClick","items","index","setIndex","leaving","setLeaving","len","useReducedMotion","window","innerWidth","h","addEventListener","passive","removeEventListener","performanceMonitor","markStart","preloadIdx","imageUrl","preloadImage","then","markEnd","catch","goNext","displayed","arr","o","min","idx","push","stackKey","id","floor","top","leaveKey","Date","now","key","setTimeout","l","handler","e","preventDefault","AnimatePresence","_ref2"],"sourceRoot":""}